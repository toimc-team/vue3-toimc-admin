var ae=Object.defineProperty;var O=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var K=(e,o,d)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[o]=d,T=(e,o)=>{for(var d in o||(o={}))te.call(o,d)&&K(e,d,o[d]);if(O)for(var d of O(o))le.call(o,d)&&K(e,d,o[d]);return e};import{e as A,g as h,h as M,_ as N,E,o as g,j as V,w as t,a as k,b as a,F as U,c as $,H as B,k as D,I as W,V as z,X as J,l as P,N as ne,r as w,t as q,a5 as S,dM as de,dN as re,dO as se,a6 as j,m as ue,q as me,W as ie}from"./index.d7d2c828.js";import{_ as pe}from"./TCard.174ec918.js";import{E as fe}from"./el-col.0af3abbb.js";import{v as ce}from"./el-loading.408727c8.js";import{E as _e}from"./el-card.a9187346.js";import{E as Q}from"./el-tree.81ebb14d.js";import"./el-checkbox.4ba5aab1.js";import{E as he}from"./el-alert.dc938fbe.js";import{s as Y,d as G,a as be,b as De,q as ge}from"./depart.0f10d426.js";/* empty css                  *//* empty css                        *//* empty css                       *//* empty css                        */import{E as Z,g as ye}from"./menu.616f0294.js";import{a as x,b as ee}from"./index2.64be7904.js";import{E as oe}from"./index2.0c6c076b.js";import{E as ve}from"./index2.4afa58e3.js";import{E as Ce}from"./index2.3031265c.js";import"./TransitionList.9f851e98.js";import"./BasicTransition.f55cbe11.js";import"./index.cf99b79d.js";import"./index2.086b66ea.js";import"./index2.6f657a77.js";const ke=A({props:{dialogFormVisible:{type:Boolean,default:!1},parentId:{type:String,default:""},treeData:{type:Array,default:()=>[]}},emits:["cancel","success"],setup(e,{emit:o}){const d=h(),r=M({departName:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:"blur"}]}),p=M({departName:"",parentId:"",orgCategory:"1",departOrder:0,mobile:"",address:"",memo:""}),b={children:"children",label:"departName",value:"id"},s="120px",l=h(!1),n=async m=>{!m||await m.validate((y,i)=>{y&&f()})},u=()=>{o("cancel")},v=()=>{p.departName="",p.parentId=e.parentId,p.orgCategory=e.parentId?"2":"1",p.departOrder=0,p.mobile="",p.address="",p.memo=""},f=()=>{l.value=!0,Y(p,!1).then(m=>{l.value=!1,m.code==200?(E({message:`${m.message}`,type:"success"}),o("success")):(u(),E({message:`${m.message}`,type:"error"}))}).catch(()=>{l.value=!1,u(),E({message:"\u64CD\u4F5C\u5931\u8D25",type:"error"})})};return{ruleFormRef:d,rules:r,defaultProps:b,formData:p,formLabelWidth:s,loading:l,opened:v,close:u,submitForm:n}}}),Ee=D("\u516C\u53F8"),Ve=D("\u90E8\u95E8"),$e=D("\u5C97\u4F4D"),Fe={class:"dialog-footer flex justify-end"},Ie=D("\u53D6\u6D88"),we=D("\u786E\u8BA4");function Be(e,o,d,r,p,b){const s=W,l=z,n=Z,u=x,v=ee,f=oe,m=J,y=P,i=ve;return g(),V(i,{"model-value":e.dialogFormVisible,title:"\u65B0\u589E",width:"520px",center:"",onClose:e.close,onOpened:e.opened},{footer:t(()=>[k("span",Fe,[a(y,{onClick:e.close},{default:t(()=>[Ie]),_:1},8,["onClick"]),a(y,{type:"primary",loading:e.loading,onClick:o[7]||(o[7]=_=>e.submitForm(e.ruleFormRef))},{default:t(()=>[we]),_:1},8,["loading"])])]),default:t(()=>[a(m,{ref:"ruleFormRef",model:e.formData,rules:e.rules},{default:t(()=>[a(l,{label:"\u673A\u6784\u540D\u79F0","label-width":e.formLabelWidth,prop:"departName"},{default:t(()=>[a(s,{modelValue:e.formData.departName,"onUpdate:modelValue":o[0]||(o[0]=_=>e.formData.departName=_),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),e.parentId!=""?(g(),V(l,{key:0,label:"\u4E0A\u7EA7\u90E8\u95E8","label-width":e.formLabelWidth},{default:t(()=>[a(n,{modelValue:e.formData.parentId,"onUpdate:modelValue":o[1]||(o[1]=_=>e.formData.parentId=_),clearable:"","node-key":"id",data:e.treeData,"default-expand-all":"",props:e.defaultProps,placeholder:" "},null,8,["modelValue","data","props"])]),_:1},8,["label-width"])):U("",!0),a(l,{label:"\u673A\u6784\u7C7B\u578B","label-width":e.formLabelWidth},{default:t(()=>[a(v,{modelValue:e.formData.orgCategory,"onUpdate:modelValue":o[2]||(o[2]=_=>e.formData.orgCategory=_)},{default:t(()=>[e.formData.orgCategory==1?(g(),V(u,{key:0,label:"1"},{default:t(()=>[Ee]),_:1})):(g(),$(B,{key:1},[a(u,{label:"2"},{default:t(()=>[Ve]),_:1}),a(u,{label:"3"},{default:t(()=>[$e]),_:1})],64))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u6392\u5E8F","label-width":e.formLabelWidth},{default:t(()=>[a(f,{modelValue:e.formData.departOrder,"onUpdate:modelValue":o[3]||(o[3]=_=>e.formData.departOrder=_),min:0,max:9999999999,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u7535\u8BDD","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.mobile,"onUpdate:modelValue":o[4]||(o[4]=_=>e.formData.mobile=_),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u5730\u5740","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.address,"onUpdate:modelValue":o[5]||(o[5]=_=>e.formData.address=_),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u5907\u6CE8","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.memo,"onUpdate:modelValue":o[6]||(o[6]=_=>e.formData.memo=_),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["model-value","onClose","onOpened"])}var Ae=N(ke,[["render",Be],["__scopeId","data-v-9a616954"]]);const Ne=A({components:{DepartFormModal:Ae},props:{treeData:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["on-node-click"],setup(e,{emit:o}){const d={children:"children",label:"departName",value:"id"},r=h(!1),p=h(!1),b=h([]),s=h(),l=h("");ne(l,c=>{s.value.filter(c)});const n=()=>{r.value=!1},u=()=>{r.value=!1},v=(c,C,L)=>{F.value=c.id,o("on-node-click",c)},f=(c,{node:C})=>{},m=(c,C)=>{b.value=C.checkedKeys},y=c=>{Ce.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u6E29\u99A8\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{let C={lds:c.id};G(C).then(L=>{E({type:"success",message:L.message})})}).catch(()=>{E({type:"info",message:"Delete canceled"})})},i=()=>{G({ids:b.value.join(",")}).then(c=>{E({type:"success",message:c.message})})},_=()=>{F.value="",r.value=!0},F=h("");return{modelParentId:F,dialogFormVisible:r,checkedKeys:b,filterText:l,treeReloading:p,defaultProps:d,onDelDepart:y,onAddDepart:_,onDeleteBatch:i,onAddChildDepart:c=>{F.value=c||"",r.value=!0},onSuccess:n,onCancel:u,filterNode:(c,C)=>c?(C.departName,C.departName.includes(c)):!0,onCheckChange:f,check:m,nodeClick:v}}}),Le={class:"flex",style:{"margin-bottom":"8px"}},Pe=D("\u65B0\u589E"),Re=D("\u6DFB\u52A0\u4E0B\u7EA7"),Te=D("\u6279\u91CF\u64CD\u4F5C"),Ue=D("\u5220\u9664"),Se={key:1},We=D("\u6DFB\u52A0\u5B50\u7EA7"),Oe=k("span",{style:{color:"red"}},"\u5220\u9664",-1);function Ke(e,o,d,r,p,b){const s=P,l=de,n=re,u=se,v=w("a-divider"),f=he,m=W,y=Q,i=w("depart-form-modal"),_=_e,F=ce;return g(),V(_,{class:"box-card border-none",style:{height:"100%"}},{default:t(()=>[k("div",Le,[a(s,{type:"primary",onClick:e.onAddDepart},{default:t(()=>[Pe]),_:1},8,["onClick"]),a(s,{type:"primary",style:{"margin-right":"8px"},disabled:!e.modelParentId,onClick:o[0]||(o[0]=I=>e.onAddChildDepart(e.modelParentId))},{default:t(()=>[Re]),_:1},8,["disabled"]),e.checkedKeys.length>0?(g(),V(u,{key:0},{dropdown:t(()=>[a(n,null,{default:t(()=>[a(l,{key:"1",onClick:e.onDeleteBatch},{default:t(()=>[Ue]),_:1},8,["onClick"])]),_:1})]),default:t(()=>[a(s,null,{default:t(()=>[Te]),_:1})]),_:1})):U("",!0)]),a(f,{"show-icon":"",type:"info",closable:!1,style:{"margin-bottom":"8px"}},{default:t(()=>[e.checkedKeys.length>0?(g(),$(B,{key:0},[k("span",null,"\u5DF2\u9009\u4E2D "+q(e.checkedKeys.length)+" \u6761\u8BB0\u5F55",1),a(v,{type:"vertical"}),k("a",{onClick:o[1]||(o[1]=I=>e.checkedKeys=[])},"\u6E05\u7A7A")],64)):(g(),$("span",Se,"\u672A\u9009\u4E2D\u4EFB\u4F55\u6570\u636E"))]),_:1}),S((g(),$("div",null,[a(m,{modelValue:e.filterText,"onUpdate:modelValue":o[2]||(o[2]=I=>e.filterText=I),placeholder:"\u6309\u90E8\u95E8\u540D\u79F0\u641C\u7D22\u2026",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),e.treeReloading?U("",!0):(g(),V(y,{key:0,ref:"treeRef",class:"filter-tree",data:e.treeData,props:e.defaultProps,"show-checkbox":"","node-key":"id","default-expand-all":"","expand-on-click-node":!1,"filter-node-method":e.filterNode,onCheckChange:e.onCheckChange,onCheck:e.check,onNodeClick:e.nodeClick},{default:t(({node:I,data:R})=>[a(u,{ref:"dropDownRef",trigger:"contextmenu",placement:"bottom-end"},{dropdown:t(()=>[a(n,null,{default:t(()=>[a(l,{onClick:c=>e.onAddChildDepart(R.id)},{default:t(()=>[We]),_:2},1032,["onClick"]),a(l,{onClick:c=>e.onDelDepart(R)},{default:t(()=>[Oe]),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[k("div",null,q(I.label),1)]),_:2},1536)]),_:1},8,["data","props","filter-node-method","onCheckChange","onCheck","onNodeClick"]))])),[[F,e.loading]]),a(i,{"parent-id":e.modelParentId,"tree-data":e.treeData,"dialog-form-visible":e.dialogFormVisible,onSuccess:e.onSuccess,onCancel:e.onCancel},null,8,["parent-id","tree-data","dialog-form-visible","onSuccess","onCancel"])]),_:1})}var Me=N(Ne,[["render",Ke]]);let H={};const qe=A({props:{treeData:{type:Array,default:()=>[]}},emits:["on-save"],setup(e,{emit:o}){const d="120px";let r=h({departName:"",parentId:"",orgCategory:"1",departOrder:0,mobile:"",address:"",memo:""});return{props:e,defaultProps:{children:"children",label:"departName",value:"id"},formLabelWidth:d,formData:r,setFormInfo:n=>{H=T({},n),r.value=n},saveInfo:()=>{o("on-save",r.value)},resetInfo:()=>{r.value=T({},H)}}}}),je=D("\u516C\u53F8"),Ge=D("\u90E8\u95E8"),He=D("\u5C97\u4F4D"),Xe={class:"form-footer flex justify-end pr-2"},ze=D("\u91CD\u7F6E"),Je=D("\u4FDD\u5B58");function Qe(e,o,d,r,p,b){const s=W,l=z,n=Z,u=x,v=ee,f=oe,m=J,y=P;return g(),$(B,null,[a(m,{model:e.formData},{default:t(()=>[a(l,{label:"\u673A\u6784\u540D\u79F0","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.departName,"onUpdate:modelValue":o[0]||(o[0]=i=>e.formData.departName=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u4E0A\u7EA7\u90E8\u95E8","label-width":e.formLabelWidth},{default:t(()=>[a(n,{modelValue:e.formData.parentId,"onUpdate:modelValue":o[1]||(o[1]=i=>e.formData.parentId=i),disabled:"","node-key":"id",data:e.treeData,props:e.defaultProps,placeholder:" ","check-strictly":""},null,8,["modelValue","data","props"])]),_:1},8,["label-width"]),a(l,{label:"\u673A\u6784\u7C7B\u578B","label-width":e.formLabelWidth},{default:t(()=>[a(v,{modelValue:e.formData.orgCategory,"onUpdate:modelValue":o[2]||(o[2]=i=>e.formData.orgCategory=i)},{default:t(()=>[e.formData.orgCategory==1?(g(),V(u,{key:0,label:"1"},{default:t(()=>[je]),_:1})):(g(),$(B,{key:1},[a(u,{label:"2"},{default:t(()=>[Ge]),_:1}),a(u,{label:"3"},{default:t(()=>[He]),_:1})],64))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u6392\u5E8F","label-width":e.formLabelWidth},{default:t(()=>[a(f,{modelValue:e.formData.departOrder,"onUpdate:modelValue":o[3]||(o[3]=i=>e.formData.departOrder=i),min:0,max:9999999999,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u7535\u8BDD","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.mobile,"onUpdate:modelValue":o[4]||(o[4]=i=>e.formData.mobile=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u5730\u5740","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.address,"onUpdate:modelValue":o[5]||(o[5]=i=>e.formData.address=i),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(l,{label:"\u5907\u6CE8","label-width":e.formLabelWidth},{default:t(()=>[a(s,{modelValue:e.formData.memo,"onUpdate:modelValue":o[6]||(o[6]=i=>e.formData.memo=i),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"]),k("div",Xe,[a(y,{onClick:e.resetInfo},{default:t(()=>[ze]),_:1},8,["onClick"]),a(y,{type:"primary",onClick:e.saveInfo},{default:t(()=>[Je]),_:1},8,["onClick"])])],64)}var Ye=N(qe,[["render",Qe]]);let X=[];const Ze=A({props:{defaultKeys:{type:Array,default:()=>[]},departId:{type:String,default:""}},setup(e){let o=h([]);const d={children:"children",label:"name",value:"id"},r=h([]),p=(n,u)=>{r.value=u.checkedKeys};return(()=>{ye().then(n=>{o.value=n==null?void 0:n.data})})(),{props:e,defaultProps:d,checkedKeys:r,treeData:o,onCheck:p,setCheckedKeys:n=>{X=[...n],r.value=n},saveInfo:()=>{let n={departId:e.departId,lastPermissionIds:X,permissionIds:r.value};be(n).then(u=>{u.code===200||E({message:`${u.message}`,type:"error"})})}}}}),xe={style:{"min-height":"360px"}},eo={class:"form-footer flex justify-end mr-2"},oo=D("\u4FDD\u5B58");function ao(e,o,d,r,p,b){const s=Q,l=P;return g(),$(B,null,[k("div",xe,[a(s,{data:e.treeData,props:e.defaultProps,"node-key":"id","default-checked-keys":e.checkedKeys,"show-checkbox":"","default-expand-all":"",onCheck:e.onCheck},null,8,["data","props","default-checked-keys","onCheck"])]),k("div",eo,[a(l,{type:"primary",onClick:e.saveInfo},{default:t(()=>[oo]),_:1},8,["onClick"])])],64)}var to=N(Ze,[["render",ao]]);const lo=A({components:{DepartLeftTree:Me,DepartInfo:Ye,DepartRole:to},setup(){const e=h("info"),o=h(""),d=h([null]),r=h(!1),p=h(),b=h(),s=f=>{o.value=f.id,r.value=!0,p.value.setFormInfo(f),l(f.id)},l=f=>{De({departId:f}).then(m=>{b.value.setCheckedKeys(m.data)})},n=h(!1);return(()=>{n.value=!0,d.value=[],ge().then(f=>{d.value=f.data,n.value=!1})})(),{loading:n,treeData:d,hasCheckNode:r,activeName:e,departId:o,departInfoRef:p,departPermissionRef:b,onSave:f=>{Y(f,!0).then(m=>{m.code===200?E({message:`${m.message}`,type:"success"}):E({message:`${m.message}`,type:"error"})})},onTreeSelect:s}}}),no={class:"pt-10"};function ro(e,o,d,r,p,b){const s=w("DepartLeftTree"),l=fe,n=w("DepartInfo"),u=ue,v=w("DepartRole"),f=me,m=pe,y=ie;return g(),V(y,{class:"p-4"},{default:t(()=>[a(l,{md:8,sm:24,xl:6},{default:t(()=>[a(s,{ref:"leftTree",loading:e.loading,"tree-data":e.treeData,onOnNodeClick:e.onTreeSelect},null,8,["loading","tree-data","onOnNodeClick"])]),_:1}),a(m,{header:"\u90E8\u95E8\u8BE6\u60C5",class:"ml-2 flex-1"},{default:t(()=>[S(a(f,{modelValue:e.activeName,"onUpdate:modelValue":o[0]||(o[0]=i=>e.activeName=i),class:"depart-tabs"},{default:t(()=>[a(u,{label:"\u57FA\u672C\u4FE1\u606F",name:"info"},{default:t(()=>[a(n,{ref:"departInfoRef","tree-data":e.treeData,onOnSave:e.onSave},null,8,["tree-data","onOnSave"])]),_:1}),a(u,{label:"\u90E8\u95E8\u6743\u9650",name:"role"},{default:t(()=>[a(v,{ref:"departPermissionRef","depart-id":e.departId},null,8,["depart-id"])]),_:1})]),_:1},8,["modelValue"]),[[j,e.hasCheckNode]]),S(k("div",no,"\u5C1A\u672A\u9009\u62E9\u90E8\u95E8",512),[[j,e.hasCheckNode==!1]])]),_:1})]),_:1})}var No=N(lo,[["render",ro],["__scopeId","data-v-216ca8ac"]]);export{No as default};
