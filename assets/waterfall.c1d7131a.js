var M=Object.defineProperty,J=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var D=(t,a,e)=>a in t?M(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,g=(t,a)=>{for(var e in a||(a={}))Q.call(a,e)&&D(t,e,a[e]);if(A)for(var e of A(a))tt.call(a,e)&&D(t,e,a[e]);return t},y=(t,a)=>J(t,q(a));import{e as z,am as at,g as b,a3 as P,b_ as et,_ as L,o as h,c as _,a as w,a$ as nt,B as Y,aH as rt,cZ as it,R as U,dX as ot,J as st,I as mt,S as B,W as S,b as N,F as ft,h as ct,ai as lt}from"./index.d88b9255.js";const dt=z({props:{url:{type:String,default:""},width:{type:String,default:"100%"}},emits:["loaded"],setup(t,{emit:a}){const e=at("lazy"),n=b(null);P(()=>{r()}),et(()=>{m()});function r(){!n.value||e.mount(n.value,t.url,i=>{const{height:o,width:f}=i;a("loaded",{dom:n.value,src:t.url,width:f,height:o})})}function m(){!n.value||e.unmount(n.value)}return{lazyRef:n}}}),bt={class:"lazy__box"},kt={ref:"lazyRef",class:"lazy__img"};function pt(t,a,e,n,r,m){return h(),_("div",bt,[w("img",kt,null,512)])}var wt=L(dt,[["render",pt],["__scopeId","data-v-0e060bae"]]);const ut=({breakpoints:t,wrapperWidth:a,gutter:e,hasAroundGutter:n,initWidth:r})=>{const m=Object.keys(t).map(c=>Number(c)).sort((c,p)=>c-p);let i=a,o=!1;for(const c of m)if(a<=c){i=c,o=!0;break}if(!o)return r;const f=t[i].rowPerView;return n?(a-e)/f-e:(a-(f-1)*e)/f};function gt(t){const a=b(0),e=b(null);nt(e,i=>{const o=i[0],{width:f}=o.contentRect;a.value=f});const n=Y(()=>ut({wrapperWidth:a.value,breakpoints:t.breakpoints,gutter:t.gutter,hasAroundGutter:t.hasAroundGutter,initWidth:t.width})),r=Y(()=>{const i=t.hasAroundGutter?-t.gutter:t.gutter;return Math.floor((a.value+i)/(n.value+t.gutter))}),m=Y(()=>{const i=t.hasAroundGutter?t.gutter:-t.gutter,o=r.value*(n.value+t.gutter)+i;return(a.value-o)/2});return{waterfallWrapper:e,wrapperWidth:a,colWidth:n,cols:r,offsetX:m}}const yt=typeof window!="undefined"&&window!==null,E=_t(),xt=Object.prototype.propertyIsEnumerable,T=Object.getOwnPropertySymbols;function ht(t,...a){return a.map(n=>n.replace(/\[(\w+)\]/g,".$1").split(".").reduce((r,m)=>r&&r[m],t))}function _t(){return yt&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function v(t){return typeof t=="function"||toString.call(t)==="[object Object]"}function vt(t){return typeof t=="object"?t===null:typeof t!="function"}function It(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}function Ot(t,...a){if(!v(t))throw new TypeError("expected the first argument to be an object");if(a.length===0||typeof Symbol!="function"||typeof T!="function")return t;for(const e of a){const n=T(e);for(const r of n)xt.call(e,r)&&(t[r]=e[r])}return t}function $(t,...a){let e=0;for(vt(t)&&(t=a[e++]),t||(t={});e<a.length;e++)if(v(a[e])){for(const n of Object.keys(a[e]))It(n)&&(v(t[n])&&v(a[e][n])?$(t[n],a[e][n]):t[n]=a[e][n]);Ot(t,a[e])}return t}function j(t,a=""){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{e(r)},r.onerror=()=>{n(new Error("Image load error"))},a&&(r.crossOrigin=a&&"Anonymous"),r.src=t})}const Yt={rootMargin:"0px",threshold:0},V="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",zt="";class Lt{constructor(a=!0,e,n){this.lazyActive=!0,this.options={loading:V,error:zt,observerOptions:Yt,log:!0},this._images=new WeakMap,this.lazyActive=a,this.colWidth=n.colWidth,this.colWidth,this.config(e)}config(a={}){$(this.options,a)}mount(a,e,n){const{src:r,loading:m,error:i}=this._valueFormatter(e);if(a.setAttribute("lazy","loading"),a.setAttribute("src",m||V),!this.lazyActive)this._setImageSrc(a,r,n,i);else{if(!E){debugger;this._setImageSrc(a,r,n,i),this._log(()=>{throw new Error("Not support IntersectionObserver!")})}this._initIntersectionObserver(a,r,n,i)}}resize(a,e){const n=a.getAttribute("lazy"),r=a.getAttribute("src");n&&n==="loaded"&&r&&j(r).then(m=>{const{width:i,height:o}=m,f=this.colWidth/i*o;a.height=f;const c=a.style;c.height=`${f}px`,e({width:i,height:o})})}unmount(a){const e=this._realObserver(a);e&&e.unobserve(a),this._images.delete(a)}_setImageSrc(a,e,n,r){!e||a.getAttribute("src")===e||j(e).then(i=>{a.setAttribute("lazy","loaded"),a.removeAttribute("src"),a.setAttribute("src",e);const{width:o,height:f}=i,c=this.colWidth/o*f;a.height=c;const p=a.style;p.height=`${c}px`,n({width:o,height:f})}).catch(()=>{const i=this._realObserver(a);i&&i.disconnect(),r&&(a.setAttribute("lazy","error"),a.setAttribute("src",r)),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${e} `)}),n()})}_isOpenLazy(){return E&&this.lazyActive}_initIntersectionObserver(a,e,n,r){const m=this.options.observerOptions;this._images.set(a,new IntersectionObserver(o=>{Array.prototype.forEach.call(o,f=>{if(f.isIntersecting){const c=this._realObserver(a);c&&c.unobserve(f.target),this._setImageSrc(a,e,n,r)}})},m));const i=this._realObserver(a);i&&i.observe(a)}_valueFormatter(a){let e=a,n=this.options.loading,r=this.options.error;return v(a)&&(e=a.src,n=a.loading||this.options.loading,r=a.error||this.options.error),{src:e,loading:n,error:r}}_log(a){this.options.log&&a()}_realObserver(a){return this._images.get(a)}}const R=z({props:{list:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},imgSelector:{type:String,default:"src"},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},gutter:{type:Number,default:10},hasAroundGutter:{type:Boolean,default:!0},animationPrefix:{type:String,default:"animate__animated"},animationEffect:{type:String,default:"fade-in"},animationDuration:{type:Number,default:1e3},animationDelay:{type:Number,default:300},backgroundColor:{type:String,default:"#fff"},lazyload:{type:Boolean,default:!0},loadProps:{type:Object,default:()=>{}},delay:{type:Number,default:300}},setup(t){const a=b(t.list.map(s=>y(g({},s),{ref:b(null)}))),e=b(0),{waterfallWrapper:n,wrapperWidth:r,colWidth:m,cols:i,offsetX:o}=gt(t),f=b([]),c=new Lt(t.lazyload,t.loadProps,{colWidth:m.value});rt("lazy",c);const p=it(async()=>{f.value=new Array(i.value).fill(t.hasAroundGutter?t.gutter:0),a.value.forEach(s=>{G(s)}),e.value=Math.max.apply(null,f.value)},t.delay);U(()=>[r,m],()=>{p()},{deep:!0}),U(()=>t.list,()=>{const s=a.value.map(l=>I(l)),d=t.list.map(l=>I(l)),k=t.list.filter(l=>!s.includes(l.src));a.value.push(...k.map(l=>y(g({},l),{ref:b(null)}))),a.value=a.value.filter(l=>d.includes(l.src)),p()},{deep:!0});const F=s=>{const d=t.hasAroundGutter?s+1:s;return t.gutter*d+m.value*s+o.value},G=async s=>{var X,Z;const d=Math.min.apply(null,f.value),k=f.value.indexOf(d),l=F(k);s.style=y(g({},s.style),{transform:`translate3d(${l}px,${d}px, 0)`,width:`${m.value}px`});const O=s.width||((X=s.ref)==null?void 0:X.clientWidth),x=s.height||((Z=s.ref)==null?void 0:Z.clientHeight),u=m.value/O*x||0;f.value[k]+=u+t.gutter,K(s,()=>{s.style=y(g({},s.style),{transition:".3s"})})},H=s=>ht(s,t.imgSelector)[0],I=(s,d)=>s[t.rowKey]||s.src||d||s;function K(s,d){const k=`${t.animationDuration/1e3}s`,l=`${t.animationDelay/1e3}s`;s.style=y(g({},s.style),{visibility:"visible",duration:k,delay:l,fillMode:"both"}),s.cls=`${t.animationPrefix} ${t.animationEffect}`,d&&setTimeout(()=>{d()},t.animationDuration+t.animationDelay)}return{waterfallWrapper:n,wrapperHeight:e,getRenderURL:H,getKey:I,handleLoaded:s=>{const{dom:d,src:k,width:l,height:O}=s;for(let x=0;x<a.value.length;x++){const u=a.value[x];if(u.src===k){u.dom=d,u.width=l,u.height=O;break}}p()},newLists:a}}}),C=()=>{ot(t=>({c3a98f92:t.backgroundColor}))},W=R.setup;R.setup=W?(t,a)=>(C(),W(t,a)):C;const Rt=R,Xt={class:"bg-gray-900 rounded-lg shadow-md overflow-hidden transition-all duration-300 ease-linear hover:shadow-lg hover:shadow-gray-600 group"},Zt={class:"overflow-hidden"};function At(t,a,e,n,r,m){const i=wt;return h(),_("ul",{ref:"waterfallWrapper",class:"waterfall-list",style:B({height:`${t.wrapperHeight}px`})},[(h(!0),_(st,null,mt(t.newLists,(o,f)=>(h(),_("li",{key:t.getKey(o,f),ref_for:!0,ref:c=>o.ref=c,class:"waterfall-item",style:B(o.style)},[w("div",{class:ft(["waterfall-card",o==null?void 0:o.cls])},[S(t.$slots,"item",{item:o,index:f},()=>[w("div",Xt,[w("div",Zt,[N(i,{url:o.src,class:"cursor-pointer transition-all duration-300 ease-linear group-hover:scale-105",onLoaded:t.handleLoaded},null,8,["url","onLoaded"])])])],!0),S(t.$slots,"default",{},void 0,!0)],2)],4))),128))],4)}var Dt=L(Rt,[["render",At],["__scopeId","data-v-65b7481a"]]),Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABN9JREFUaEPtWM1rJEUUf69nujebjUFDj7FqZggBkUWiKJkIYf0C2Yuag5f8AyKukMU9eRA0m1VYvLkeJKKehYigRg8ushFWjZgEFj0Y9JBDJtU9M00UiTGZ7uknJdMy29Ofk5noyBb0pevV771fvVev3iuEPh/Y5/bDLQL/tge75gHDMKaI6BkAeAwA7mh+tzcJ/gYAv8qPiL5wXffjYrH4QzfIH4mAZVn5er1+joieRsQH0hhERN8h4peapi3qur6TZm2rbEcEarUadxxHGv4cANzVqfLmOhMR381ms4u5XE6kxUpNQAhxDgDmu2C431YTAN7gnL+ZhkQqAkIICf5iGgVpZRHxQ8bYbNJ1iQiUy+V7FEV5DwAeSQp8RLky57yYBCMRAcMw5onoYgLAb4jomqqqVwHA3N3drcg1IyMjozLkbNs+oyjKWSJ6Ig4LEX9kjN0fKxcnQESaEGIdEe+LkH0fEd9hjK3F4cn5Zsp9HgCejZJHxIuMsYVImajJ9fV1dWxsbMC27WsAUPLLIuJXAPBSUsP965tE3g7C9mRlpsvn8zJ8A0doCBERViqVwUwmoziOU5Kh4UOQO34eEe0kux4lI4T4HACeDJExVVWdDEuxUQQ0y7JOeKCO45x2XfcyIrqIeIUxJpV2bRiG8RYRnQ8CRMTXGGOvBs4F/SQipVarDSJiG8GDgwOnWCz+2TXLW4AMw/iUiGYCsE1N00pBN3agB4johGVZWpCRKysr+7Ozs40eEZD11Pch2K9zzl9pO4dBwqZpnpKx75/b29uzx8fHD3phvIcphJAHNig73eCcPxhLYH5+Xpmbmzt13Lvv6WtmpkAvIOJD/ozXFkJe6vQTsG27wTnf7+Xut3jhawA4E6DrMuf85db/bQTC4l/X9UNErB8HAcMwLhFRW7wDwLec85uItRHY3t4+OTAwkPUbquv6PiL25PD6dVWr1Ycdx7kesFk/cc7vjfRA2AHWdf0PeQcchweq1erdjuP8EpROOecskkC1Wh0Kyv+6ru8hIh0Hgc3NzduGh4d/D9B1wDk/+f8m0Pch1PeHOCyNViqVw4mJiWNJozs7O5cQsbM0GnaR6bruIGJPijj/YRVCHOkiQ8uyhvq2lJCGCyEGVVXN/JeKOSK6kc/n44s5aXTfl9NRDU2vijoiUk3TvEpEjwfdwKkamqYXbmopW0F70ZUJIRYBQL5UtI3ULWWTwD9NfRCorut1RDzsRmlhGMZTRPRZCFZnTb0EC0upniLpidXV1XqnLebS0lJmenpay2QynwDA2RACL3DOpXcCR+zL3NbW1sDQ0JAatdOy1VxbW7OTEpGGT01NqR5u2LsTAFzhnF+I0h1LQC4Oq4/8wPKAM8YcAJB9g6xcvepV6pFfxjCMrD9Fh7w7XeecPxoXookIRN0NcQqSznvvTgBwp6IoHzUajQ8KhcLPcesTE4jLTHGKks6nbV1TEfAOdqFQkAev7dklqZFBco1Gwy2Xy/VSqZTqqTI1AS/FAoBaq9W0oO4tDREiolwuJ6tcu5OOryMCnoHyxpZEKpVKNq1H5I6Pjo7KAy8N77jXPhKB1p2WD2IzMzOZyclJpVwuK6qqKoqi/I3vui7Ztu0WCgV3Y2PDXV5ebiwsLHRsdKverhFIEzbdlL1FoJu72QlW33vgL+ntak98Gx9aAAAAAElFTkSuQmCC";const Bt=z({setup(){async function t(){const m=[];try{const i=await lt.get("/api/public/mix");if(i.status===200){const o=i.data;o.code===200&&m.push(...o.data||[])}}catch(i){}return m}function a(){const m=b([]),i=ct({rowKey:"id",gutter:10,hasAroundGutter:!0,width:320,breakpoints:{1200:{rowPerView:4},800:{rowPerView:3},500:{rowPerView:2}},animationEffect:"animate__fadeInUp",animationDuration:1e3,animationDelay:300,backgroundColor:"#2C2E3A",imgSelector:"src.original",loadProps:{loading:Ut},lazyload:!0});P(async()=>{await o()});async function o(){(await t()).map(c=>{m.value.push({src:c})})}return{list:m,options:i,handleLoadMore:o}}const{list:e,options:n,handleLoadMore:r}=a();return{list:e,options:n,handleLoadMore:r}}}),St={class:"h-screen flex overflow-hidden"},Et={class:"flex-auto overflow-y-auto"},Tt={class:"flex justify-center py-10 bg-gray-900"};function jt(t,a,e,n,r,m){const i=Dt;return h(),_("div",St,[w("div",Et,[N(i,{list:t.list,"row-key":t.options.rowKey,gutter:t.options.gutter,"has-around-gutter":t.options.hasAroundGutter,width:t.options.width,breakpoints:t.options.breakpoints,"img-selector":t.options.imgSelector,"background-color":t.options.backgroundColor,"animation-effect":t.options.animationEffect,"animation-duration":t.options.animationDuration,"animation-delay":t.options.animationDelay,lazyload:t.options.lazyload,"load-props":t.options.loadProps},null,8,["list","row-key","gutter","has-around-gutter","width","breakpoints","img-selector","background-color","animation-effect","animation-duration","animation-delay","lazyload","load-props"]),w("div",Tt,[w("button",{class:"px-5 py-2 rounded-full bg-gray-700 text-md text-white cursor-pointer hover:bg-gray-800 transition-all duration-300",onClick:a[0]||(a[0]=(...o)=>t.handleLoadMore&&t.handleLoadMore(...o))},"\u52A0\u8F7D\u66F4\u591A")])])])}var Pt=L(Bt,[["render",jt]]);export{Pt as default};
