var ke=Object.defineProperty,xe=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var ue=(l,s,n)=>s in l?ke(l,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[s]=n,j=(l,s)=>{for(var n in s||(s={}))ze.call(s,n)&&ue(l,n,s[n]);if(ce)for(var n of ce(s))Le.call(s,n)&&ue(l,n,s[n]);return l},J=(l,s)=>xe(l,Ie(s));import{ab as D,s as fe,x as oe,ak as ve,e as pe,cy as de,cz as Ce,cA as Ee,au as me,A as ge,ad as Se,g,cB as Oe,bm as Te,B as w,an as we,R as le,aJ as he,a3 as ye,o as _,j as se,b as c,w as b,a as p,F as f,C as t,a9 as Ne,H as k,D as E,bh as Ae,c as T,b5 as $e,as as Be,J as re,cC as De,bi as Me,G as Ve,cD as Ye,cE as Fe,I as Re,a7 as He,a8 as je,S as ie,W as K,aa as Pe,cd as Xe,L as be,cF as ne,a6 as B,a4 as M,cG as Ze,ap as _e,by as We,cH as Ge,T as Je,t as Ke,ae as qe,af as Qe,cI as Ue,cJ as et,cK as tt}from"./index.b0500663.js";const at=()=>D&&/firefox/i.test(window.navigator.userAgent),nt=fe({urlList:{type:oe(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ot={close:()=>!0,switch:l=>typeof l=="number"},lt=["src"],st={name:"ElImageViewer"},rt=pe(J(j({},st),{props:nt,emits:ot,setup(l,{emit:s}){const n=l,L={CONTAIN:{name:"contain",icon:de(Ce)},ORIGINAL:{name:"original",icon:de(Ee)}},q=at()?"DOMMouseScroll":"mousewheel",{t:S}=me(),r=ge("image-viewer"),{nextZIndex:Q}=Se(),O=g(),x=g([]),C=Oe(),h=g(!0),u=g(n.initialIndex),v=Te(L.CONTAIN),i=g({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=w(()=>{const{urlList:a}=n;return a.length<=1}),N=w(()=>u.value===0),P=w(()=>u.value===n.urlList.length-1),U=w(()=>n.urlList[u.value]),Y=w(()=>{const{scale:a,deg:e,offsetX:o,offsetY:d,enableTransition:I}=i.value;let m=o/a,z=d/a;switch(e%360){case 90:case-270:[m,z]=[z,-m];break;case 180:case-180:[m,z]=[-m,-z];break;case 270:case-90:[m,z]=[-z,m];break}const $={transform:`scale(${a}) rotate(${e}deg) translate(${m}px, ${z}px)`,transition:I?"transform .3s":""};return v.value.name===L.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$}),ee=w(()=>we(n.zIndex)?n.zIndex:Q());function A(){te(),s("close")}function F(){const a=ne(o=>{switch(o.code){case B.esc:n.closeOnPressEscape&&A();break;case B.space:H();break;case B.left:W();break;case B.up:y("zoomIn");break;case B.right:G();break;case B.down:y("zoomOut");break}}),e=ne(o=>{(o.wheelDelta?o.wheelDelta:-o.detail)>0?y("zoomIn",{zoomRate:1.2,enableTransition:!1}):y("zoomOut",{zoomRate:1.2,enableTransition:!1})});C.run(()=>{M(document,"keydown",a),M(document,q,e)})}function te(){C.stop()}function ae(){h.value=!1}function X(a){h.value=!1,a.target.alt=S("el.image.error")}function Z(a){if(h.value||a.button!==0||!O.value)return;i.value.enableTransition=!1;const{offsetX:e,offsetY:o}=i.value,d=a.pageX,I=a.pageY,m=ne($=>{i.value=J(j({},i.value),{offsetX:e+$.pageX-d,offsetY:o+$.pageY-I})}),z=M(document,"mousemove",m);M(document,"mouseup",()=>{z()}),a.preventDefault()}function R(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function H(){if(h.value)return;const a=Ze(L),e=Object.values(L),o=v.value.name,I=(e.findIndex(m=>m.name===o)+1)%a.length;v.value=L[a[I]],R()}function W(){if(N.value&&!n.infinite)return;const a=n.urlList.length;u.value=(u.value-1+a)%a}function G(){if(P.value&&!n.infinite)return;const a=n.urlList.length;u.value=(u.value+1)%a}function y(a,e={}){if(h.value)return;const{zoomRate:o,rotateDeg:d,enableTransition:I}=j({zoomRate:1.4,rotateDeg:90,enableTransition:!0},e);switch(a){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/o).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*o).toFixed(3)));break;case"clockwise":i.value.deg+=d;break;case"anticlockwise":i.value.deg-=d;break}i.value.enableTransition=I}return le(U,()=>{he(()=>{const a=x.value[0];a!=null&&a.complete||(h.value=!0)})}),le(u,a=>{R(),s("switch",a)}),ye(()=>{var a,e;F(),(e=(a=O.value)==null?void 0:a.focus)==null||e.call(a)}),(a,e)=>(_(),se(Xe,{to:"body",disabled:!a.teleported},[c(Pe,{name:"viewer-fade",appear:""},{default:b(()=>[p("div",{ref_key:"wrapper",ref:O,tabindex:-1,class:f(t(r).e("wrapper")),style:ie({zIndex:t(ee)})},[p("div",{class:f(t(r).e("mask")),onClick:e[0]||(e[0]=Ne(o=>a.hideOnClickModal&&A(),["self"]))},null,2),k(" CLOSE "),p("span",{class:f([t(r).e("btn"),t(r).e("close")]),onClick:A},[c(t(E),null,{default:b(()=>[c(t(Ae))]),_:1})],2),k(" ARROW "),t(V)?k("v-if",!0):(_(),T(re,{key:0},[p("span",{class:f([t(r).e("btn"),t(r).e("prev"),t(r).is("disabled",!a.infinite&&t(N))]),onClick:W},[c(t(E),null,{default:b(()=>[c(t($e))]),_:1})],2),p("span",{class:f([t(r).e("btn"),t(r).e("next"),t(r).is("disabled",!a.infinite&&t(P))]),onClick:G},[c(t(E),null,{default:b(()=>[c(t(Be))]),_:1})],2)],64)),k(" ACTIONS "),p("div",{class:f([t(r).e("btn"),t(r).e("actions")])},[p("div",{class:f(t(r).e("actions__inner"))},[c(t(E),{onClick:e[1]||(e[1]=o=>y("zoomOut"))},{default:b(()=>[c(t(De))]),_:1}),c(t(E),{onClick:e[2]||(e[2]=o=>y("zoomIn"))},{default:b(()=>[c(t(Me))]),_:1}),p("i",{class:f(t(r).e("actions__divider"))},null,2),c(t(E),{onClick:H},{default:b(()=>[(_(),se(Ve(t(v).icon)))]),_:1}),p("i",{class:f(t(r).e("actions__divider"))},null,2),c(t(E),{onClick:e[3]||(e[3]=o=>y("anticlockwise"))},{default:b(()=>[c(t(Ye))]),_:1}),c(t(E),{onClick:e[4]||(e[4]=o=>y("clockwise"))},{default:b(()=>[c(t(Fe))]),_:1})],2)],2),k(" CANVAS "),p("div",{class:f(t(r).e("canvas"))},[(_(!0),T(re,null,Re(a.urlList,(o,d)=>He((_(),T("img",{ref_for:!0,ref:I=>x.value[d]=I,key:o,src:o,style:ie(t(Y)),class:f(t(r).e("img")),onLoad:ae,onError:X,onMousedown:Z},null,46,lt)),[[je,d===u.value]])),128))],2),K(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var it=be(rt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ct=_e(it),ut=fe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:oe([String,Object])},previewSrcList:{type:oe(Array),default:()=>ve([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),dt={error:l=>l instanceof Event,switch:l=>we(l),close:()=>!0},ft=["src","loading"],vt={key:0},pt={name:"ElImage",inheritAttrs:!1},mt=pe(J(j({},pt),{props:ut,emits:dt,setup(l,{emit:s}){const n=l;let L="";const{t:q}=me(),S=ge("image"),r=We(),Q=Ge(),O=g(),x=g(!1),C=g(!0),h=g(!1),u=g(),v=g(),i=D&&"loading"in HTMLImageElement.prototype;let V,N;const P=w(()=>r.style),U=w(()=>{const{fit:e}=n;return D&&e?{objectFit:e}:{}}),Y=w(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),ee=w(()=>{const{previewSrcList:e,initialIndex:o}=n;let d=o;return o>e.length-1&&(d=0),d}),A=w(()=>n.loading==="eager"?!1:!i&&n.loading==="lazy"||n.lazy),F=()=>{!D||(C.value=!0,x.value=!1,O.value=n.src)};function te(){C.value=!1,x.value=!1}function ae(e){C.value=!1,x.value=!0,s("error",e)}function X(){et(u.value,v.value)&&(F(),H())}const Z=tt(X,200);async function R(){var e;if(!D)return;await he();const{scrollContainer:o}=n;qe(o)?v.value=o:Qe(o)&&o!==""?v.value=(e=document.querySelector(o))!=null?e:void 0:u.value&&(v.value=Ue(u.value)),v.value&&(V=M(v,"scroll",Z),setTimeout(()=>X(),100))}function H(){!D||!v.value||!Z||(V==null||V(),v.value=void 0)}function W(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function G(){!Y.value||(N=M("wheel",W,{passive:!1}),L=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0)}function y(){N==null||N(),document.body.style.overflow=L,h.value=!1,s("close")}function a(e){s("switch",e)}return le(()=>n.src,()=>{A.value?(C.value=!0,x.value=!1,H(),R()):F()}),ye(()=>{A.value?R():F()}),(e,o)=>(_(),T("div",{ref_key:"container",ref:u,class:f([t(S).b(),e.$attrs.class]),style:ie(t(P))},[O.value!==void 0&&!x.value?(_(),T("img",Je({key:0},t(Q),{src:O.value,loading:e.loading,style:t(U),class:[t(S).e("inner"),t(Y)?t(S).e("preview"):""],onClick:G,onLoad:te,onError:ae}),null,16,ft)):k("v-if",!0),C.value?K(e.$slots,"placeholder",{key:1},()=>[p("div",{class:f(t(S).e("placeholder"))},null,2)]):x.value?K(e.$slots,"error",{key:2},()=>[p("div",{class:f(t(S).e("error"))},Ke(t(q)("el.image.error")),3)]):k("v-if",!0),t(Y)?(_(),T(re,{key:3},[h.value?(_(),se(t(ct),{key:0,"z-index":e.zIndex,"initial-index":t(ee),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:y,onSwitch:a},{default:b(()=>[e.$slots.viewer?(_(),T("div",vt,[K(e.$slots,"viewer")])):k("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):k("v-if",!0)],64)):k("v-if",!0)],6))}}));var gt=be(mt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const yt=_e(gt);export{yt as E};
