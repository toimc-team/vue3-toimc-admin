import{ab as B,s as ue,x as te,al as ce,ao as re,e as de,cC as ie,cD as ye,cE as ke,av as fe,A as ve,ad as be,g as p,cF as he,bo as Ie,B as g,R as se,aK as me,a3 as pe,o as w,j as ne,b as r,w as _,a as f,F as i,C as a,a9 as _e,H as y,D as S,bk as Le,c as x,bb as Ce,at as ze,J as le,cG as Ee,bl as Se,G as xe,cH as Oe,cI as Ne,I as Te,a7 as $e,a8 as Ae,S as oe,W as K,aa as Me,ch as Be,L as ge,cJ as ae,a6 as M,a4 as D,cK as De,aq as we,bB as Ve,cL as Fe,T as Re,t as Ye,ae as He,af as Pe,cM as Xe,cN as je,cO as We}from"./index.6b8e7d20.js";const Ge=()=>B&&/firefox/i.test(window.navigator.userAgent),Ke=ue({urlList:{type:te(Array),default:()=>ce([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),Ze={close:()=>!0,switch:v=>re(v)},qe=["src"],Je={name:"ElImageViewer"},Qe=de({...Je,props:Ke,emits:Ze,setup(v,{emit:O}){const n=v,E={CONTAIN:{name:"contain",icon:ie(ye)},ORIGINAL:{name:"original",icon:ie(ke)}},Z=Ge()?"DOMMouseScroll":"mousewheel",{t:L}=fe(),l=ve("image-viewer"),{nextZIndex:q}=be(),N=p(),k=p([]),b=he(),h=p(!0),u=p(n.initialIndex),d=Ie(E.CONTAIN),o=p({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=g(()=>{const{urlList:t}=n;return t.length<=1}),T=g(()=>u.value===0),P=g(()=>u.value===n.urlList.length-1),J=g(()=>n.urlList[u.value]),F=g(()=>{const{scale:t,deg:e,offsetX:s,offsetY:c,enableTransition:C}=o.value;let m=s/t,z=c/t;switch(e%360){case 90:case-270:[m,z]=[z,-m];break;case 180:case-180:[m,z]=[-m,-z];break;case 270:case-90:[m,z]=[-z,m];break}const A={transform:`scale(${t}) rotate(${e}deg) translate(${m}px, ${z}px)`,transition:C?"transform .3s":""};return d.value.name===E.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A}),Q=g(()=>re(n.zIndex)?n.zIndex:q());function $(){U(),O("close")}function R(){const t=ae(s=>{switch(s.code){case M.esc:n.closeOnPressEscape&&$();break;case M.space:H();break;case M.left:W();break;case M.up:I("zoomIn");break;case M.right:G();break;case M.down:I("zoomOut");break}}),e=ae(s=>{(s.wheelDelta?s.wheelDelta:-s.detail)>0?I("zoomIn",{zoomRate:1.2,enableTransition:!1}):I("zoomOut",{zoomRate:1.2,enableTransition:!1})});b.run(()=>{D(document,"keydown",t),D(document,Z,e)})}function U(){b.stop()}function ee(){h.value=!1}function X(t){h.value=!1,t.target.alt=L("el.image.error")}function j(t){if(h.value||t.button!==0||!N.value)return;o.value.enableTransition=!1;const{offsetX:e,offsetY:s}=o.value,c=t.pageX,C=t.pageY,m=ae(A=>{o.value={...o.value,offsetX:e+A.pageX-c,offsetY:s+A.pageY-C}}),z=D(document,"mousemove",m);D(document,"mouseup",()=>{z()}),t.preventDefault()}function Y(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function H(){if(h.value)return;const t=De(E),e=Object.values(E),s=d.value.name,C=(e.findIndex(m=>m.name===s)+1)%t.length;d.value=E[t[C]],Y()}function W(){if(T.value&&!n.infinite)return;const t=n.urlList.length;u.value=(u.value-1+t)%t}function G(){if(P.value&&!n.infinite)return;const t=n.urlList.length;u.value=(u.value+1)%t}function I(t,e={}){if(h.value)return;const{zoomRate:s,rotateDeg:c,enableTransition:C}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...e};switch(t){case"zoomOut":o.value.scale>.2&&(o.value.scale=Number.parseFloat((o.value.scale/s).toFixed(3)));break;case"zoomIn":o.value.scale<7&&(o.value.scale=Number.parseFloat((o.value.scale*s).toFixed(3)));break;case"clockwise":o.value.deg+=c;break;case"anticlockwise":o.value.deg-=c;break}o.value.enableTransition=C}return se(J,()=>{me(()=>{const t=k.value[0];t!=null&&t.complete||(h.value=!0)})}),se(u,t=>{Y(),O("switch",t)}),pe(()=>{var t,e;R(),(e=(t=N.value)==null?void 0:t.focus)==null||e.call(t)}),(t,e)=>(w(),ne(Be,{to:"body",disabled:!t.teleported},[r(Me,{name:"viewer-fade",appear:""},{default:_(()=>[f("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:i(a(l).e("wrapper")),style:oe({zIndex:a(Q)})},[f("div",{class:i(a(l).e("mask")),onClick:e[0]||(e[0]=_e(s=>t.hideOnClickModal&&$(),["self"]))},null,2),y(" CLOSE "),f("span",{class:i([a(l).e("btn"),a(l).e("close")]),onClick:$},[r(a(S),null,{default:_(()=>[r(a(Le))]),_:1})],2),y(" ARROW "),a(V)?y("v-if",!0):(w(),x(le,{key:0},[f("span",{class:i([a(l).e("btn"),a(l).e("prev"),a(l).is("disabled",!t.infinite&&a(T))]),onClick:W},[r(a(S),null,{default:_(()=>[r(a(Ce))]),_:1})],2),f("span",{class:i([a(l).e("btn"),a(l).e("next"),a(l).is("disabled",!t.infinite&&a(P))]),onClick:G},[r(a(S),null,{default:_(()=>[r(a(ze))]),_:1})],2)],64)),y(" ACTIONS "),f("div",{class:i([a(l).e("btn"),a(l).e("actions")])},[f("div",{class:i(a(l).e("actions__inner"))},[r(a(S),{onClick:e[1]||(e[1]=s=>I("zoomOut"))},{default:_(()=>[r(a(Ee))]),_:1}),r(a(S),{onClick:e[2]||(e[2]=s=>I("zoomIn"))},{default:_(()=>[r(a(Se))]),_:1}),f("i",{class:i(a(l).e("actions__divider"))},null,2),r(a(S),{onClick:H},{default:_(()=>[(w(),ne(xe(a(d).icon)))]),_:1}),f("i",{class:i(a(l).e("actions__divider"))},null,2),r(a(S),{onClick:e[3]||(e[3]=s=>I("anticlockwise"))},{default:_(()=>[r(a(Oe))]),_:1}),r(a(S),{onClick:e[4]||(e[4]=s=>I("clockwise"))},{default:_(()=>[r(a(Ne))]),_:1})],2)],2),y(" CANVAS "),f("div",{class:i(a(l).e("canvas"))},[(w(!0),x(le,null,Te(t.urlList,(s,c)=>$e((w(),x("img",{ref_for:!0,ref:C=>k.value[c]=C,key:s,src:s,style:oe(a(F)),class:i(a(l).e("img")),onLoad:ee,onError:X,onMousedown:j},null,46,qe)),[[Ae,c===u.value]])),128))],2),K(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Ue=ge(Qe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ea=we(Ue),aa=ue({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:te([String,Object])},previewSrcList:{type:te(Array),default:()=>ce([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),ta={load:v=>v instanceof Event,error:v=>v instanceof Event,switch:v=>re(v),close:()=>!0},sa=["src","loading"],na={key:0},la={name:"ElImage",inheritAttrs:!1},oa=de({...la,props:aa,emits:ta,setup(v,{emit:O}){const n=v;let E="";const{t:Z}=fe(),L=ve("image"),l=Ve(),q=Fe(),N=p(),k=p(!1),b=p(!0),h=p(!1),u=p(),d=p(),o=B&&"loading"in HTMLImageElement.prototype;let V,T;const P=g(()=>l.style),J=g(()=>{const{fit:e}=n;return B&&e?{objectFit:e}:{}}),F=g(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),Q=g(()=>{const{previewSrcList:e,initialIndex:s}=n;let c=s;return s>e.length-1&&(c=0),c}),$=g(()=>n.loading==="eager"?!1:!o&&n.loading==="lazy"||n.lazy),R=()=>{!B||(b.value=!0,k.value=!1,N.value=n.src)};function U(e){b.value=!1,k.value=!1,O("load",e)}function ee(e){b.value=!1,k.value=!0,O("error",e)}function X(){je(u.value,d.value)&&(R(),H())}const j=We(X,200);async function Y(){var e;if(!B)return;await me();const{scrollContainer:s}=n;He(s)?d.value=s:Pe(s)&&s!==""?d.value=(e=document.querySelector(s))!=null?e:void 0:u.value&&(d.value=Xe(u.value)),d.value&&(V=D(d,"scroll",j),setTimeout(()=>X(),100))}function H(){!B||!d.value||!j||(V==null||V(),d.value=void 0)}function W(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function G(){!F.value||(T=D("wheel",W,{passive:!1}),E=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0)}function I(){T==null||T(),document.body.style.overflow=E,h.value=!1,O("close")}function t(e){O("switch",e)}return se(()=>n.src,()=>{$.value?(b.value=!0,k.value=!1,H(),Y()):R()}),pe(()=>{$.value?Y():R()}),(e,s)=>(w(),x("div",{ref_key:"container",ref:u,class:i([a(L).b(),e.$attrs.class]),style:oe(a(P))},[N.value!==void 0&&!k.value?(w(),x("img",Re({key:0},a(q),{src:N.value,loading:e.loading,style:a(J),class:[a(L).e("inner"),a(F)&&a(L).e("preview"),b.value&&a(L).is("loading")],onClick:G,onLoad:U,onError:ee}),null,16,sa)):y("v-if",!0),b.value||k.value?(w(),x("div",{key:1,class:i(a(L).e("wrapper"))},[b.value?K(e.$slots,"placeholder",{key:0},()=>[f("div",{class:i(a(L).e("placeholder"))},null,2)]):k.value?K(e.$slots,"error",{key:1},()=>[f("div",{class:i(a(L).e("error"))},Ye(a(Z)("el.image.error")),3)]):y("v-if",!0)],2)):y("v-if",!0),a(F)?(w(),x(le,{key:2},[h.value?(w(),ne(a(ea),{key:0,"z-index":e.zIndex,"initial-index":a(Q),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:I,onSwitch:t},{default:_(()=>[e.$slots.viewer?(w(),x("div",na,[K(e.$slots,"viewer")])):y("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):y("v-if",!0)],64)):y("v-if",!0)],6))}});var ra=ge(oa,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ua=we(ra);export{ua as E};
