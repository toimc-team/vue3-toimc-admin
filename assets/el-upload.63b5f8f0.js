var me=Object.defineProperty,ye=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var Z=(s,n,t)=>n in s?me(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,P=(s,n)=>{for(var t in n||(n={}))ge.call(n,t)&&Z(s,t,n[t]);if(Y)for(var t of Y(n))be.call(n,t)&&Z(s,t,n[t]);return s},T=(s,n)=>ye(s,he(n));import{e as z,am as re,o as m,c as R,a as O,bd as G,be as ke,Y as N,Z as y,ai as V,ay as k,aq as $e,z as A,g as J,j as U,w as C,G as Ee,C as h,ba as a,a$ as ie,S as _,F as g,b as L,v as D,t as Q,a7 as B,O as we,bf as _e,bg as Ce,H as Re,bh as Se,B as q,bi as Ue,aj as Le,bj as W,bk as Pe,N as x,aT as Te,b8 as Fe,bl as Oe,A as ee,aX as De,aC as Be,bm as ze,R as te,P as se,al as He}from"./index.d62185ec.js";import{E as je}from"./el-progress.8f81ab7f.js";import{c as Ae}from"./check.64e1d9b4.js";import{z as Ne}from"./zoom-in.e8ab6245.js";const Ve=z({name:"Delete"}),qe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Me=O("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1),Ke=[Me];function Ie(s,n,t,d,u,i){return m(),R("svg",qe,Ke)}var Xe=re(Ve,[["render",Ie]]);const We=z({name:"Document"}),Ge={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Je=O("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1),Ye=[Je];function Ze(s,n,t,d,u,i){return m(),R("svg",Ge,Ye)}var Qe=re(We,[["render",Ze]]);const ue=Symbol("uploadContextKey"),xe="ElUpload";class et extends Error{constructor(n,t,d,u){super(n),this.name="UploadAjaxError",this.status=t,this.method=d,this.url=u}}function ae(s,n,t){let d;return t.response?d=`${t.response.error||t.response}`:t.responseText?d=`${t.responseText}`:d=`fail to ${n.method} ${s} ${t.status}`,new et(d,t.status,n.method,s)}function tt(s){const n=s.responseText||s.response;if(!n)return n;try{return JSON.parse(n)}catch{return n}}const st=s=>{typeof XMLHttpRequest=="undefined"&&G(xe,"XMLHttpRequest is undefined");const n=new XMLHttpRequest,t=s.action;n.upload&&n.upload.addEventListener("progress",i=>{const f=i;f.percent=i.total>0?i.loaded/i.total*100:0,s.onProgress(f)});const d=new FormData;if(s.data)for(const[i,f]of Object.entries(s.data))Array.isArray(f)?d.append(i,...f):d.append(i,f);d.append(s.filename,s.file,s.file.name),n.addEventListener("error",()=>{s.onError(ae(t,s,n))}),n.addEventListener("load",()=>{if(n.status<200||n.status>=300)return s.onError(ae(t,s,n));s.onSuccess(tt(n))}),n.open(s.method,t,!0),s.withCredentials&&"withCredentials"in n&&(n.withCredentials=!0);const u=s.headers||{};if(u instanceof Headers)u.forEach((i,f)=>n.setRequestHeader(f,i));else for(const[i,f]of Object.entries(u))ke(f)||n.setRequestHeader(i,String(f));return n.send(d),n},de=["text","picture","picture-card"];let at=1;const ce=()=>Date.now()+at++,pe=N({action:{type:String,default:"#"},headers:{type:y(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>V({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:y(Array),default:()=>V([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:de,default:"text"},httpRequest:{type:y(Function),default:st},disabled:Boolean,limit:Number}),ot=N(T(P({},pe),{beforeUpload:{type:y(Function),default:k},beforeRemove:{type:y(Function)},onRemove:{type:y(Function),default:k},onChange:{type:y(Function),default:k},onPreview:{type:y(Function),default:k},onSuccess:{type:y(Function),default:k},onProgress:{type:y(Function),default:k},onError:{type:y(Function),default:k},onExceed:{type:y(Function),default:k}})),nt=N({files:{type:y(Array),default:()=>V([])},disabled:{type:Boolean,default:!1},handlePreview:{type:y(Function),default:k},listType:{type:String,values:de,default:"text"}}),lt={remove:s=>!!s},rt=["onKeydown"],it=["src"],ut=["onClick"],dt=["onClick"],ct=["onClick"],pt={name:"ElUploadList"},ft=z(T(P({},pt),{props:nt,emits:lt,setup(s,{emit:n}){const t=s,{t:d}=$e(),u=A("upload"),i=A("icon"),f=A("list"),w=J(!1),S=r=>{t.handlePreview(r)},$=r=>{n("remove",r)};return(r,b)=>(m(),U(Se,{tag:"ul",class:h([a(u).b("list"),a(u).bm("list",r.listType),a(u).is("disabled",r.disabled)]),name:a(f).b()},{default:C(()=>[(m(!0),R(Re,null,Ee(r.files,o=>(m(),R("li",{key:o.uid||o.name,class:h([a(u).be("list","item"),a(u).is(o.status),{focusing:w.value}]),tabindex:"0",onKeydown:ie(e=>!r.disabled&&$(o),["delete"]),onFocus:b[0]||(b[0]=e=>w.value=!0),onBlur:b[1]||(b[1]=e=>w.value=!1),onClick:b[2]||(b[2]=e=>w.value=!1)},[_(r.$slots,"default",{file:o},()=>[r.listType==="picture"||o.status!=="uploading"&&r.listType==="picture-card"?(m(),R("img",{key:0,class:h(a(u).be("list","item-thumbnail")),src:o.url,alt:""},null,10,it)):g("v-if",!0),r.listType!=="picture"&&(o.status==="uploading"||r.listType!=="picture-card")?(m(),R("div",{key:1,class:h(a(u).be("list","item-info"))},[O("a",{class:h(a(u).be("list","item-name")),onClick:B(e=>S(o),["prevent"])},[L(a(D),{class:h(a(i).m("document"))},{default:C(()=>[L(a(Qe))]),_:1},8,["class"]),O("span",{class:h(a(u).be("list","item-file-name"))},Q(o.name),3)],10,ut),o.status==="uploading"?(m(),U(a(je),{key:0,type:r.listType==="picture-card"?"circle":"line","stroke-width":r.listType==="picture-card"?6:2,percentage:Number(o.percentage),style:we(r.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):g("v-if",!0)],2)):g("v-if",!0),O("label",{class:h(a(u).be("list","item-status-label"))},[r.listType==="text"?(m(),U(a(D),{key:0,class:h([a(i).m("upload-success"),a(i).m("circle-check")])},{default:C(()=>[L(a(_e))]),_:1},8,["class"])):["picture-card","picture"].includes(r.listType)?(m(),U(a(D),{key:1,class:h([a(i).m("upload-success"),a(i).m("check")])},{default:C(()=>[L(a(Ae))]),_:1},8,["class"])):g("v-if",!0)],2),r.disabled?g("v-if",!0):(m(),U(a(D),{key:2,class:h(a(i).m("close")),onClick:e=>$(o)},{default:C(()=>[L(a(Ce))]),_:2},1032,["class","onClick"])),g(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),g(" This is a bug which needs to be fixed "),g(" TODO: Fix the incorrect navigation interaction "),r.disabled?g("v-if",!0):(m(),R("i",{key:3,class:h(a(i).m("close-tip"))},Q(a(d)("el.upload.deleteTip")),3)),r.listType==="picture-card"?(m(),R("span",{key:4,class:h(a(u).be("list","item-actions"))},[O("span",{class:h(a(u).be("list","item-preview")),onClick:e=>r.handlePreview(o)},[L(a(D),{class:h(a(i).m("zoom-in"))},{default:C(()=>[L(a(Ne))]),_:1},8,["class"])],10,dt),r.disabled?g("v-if",!0):(m(),R("span",{key:0,class:h(a(u).be("list","item-delete")),onClick:e=>$(o)},[L(a(D),{class:h(a(i).m("delete"))},{default:C(()=>[L(a(Xe))]),_:1},8,["class"])],10,ct))],2)):g("v-if",!0)])],42,rt))),128)),_(r.$slots,"append")]),_:3},8,["class","name"]))}}));var oe=q(ft,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const vt=N({disabled:{type:Boolean,default:!1}}),mt={file:s=>Ue(s)},yt=["onDrop","onDragover"],ht={name:"ElUploadDrag"},gt=z(T(P({},ht),{props:vt,emits:mt,setup(s,{emit:n}){const t=s,d="ElUploadDrag",u=Le(ue);u||G(d,"usage: <el-upload><el-upload-dragger /></el-upload>");const i=A("upload"),f=J(!1),w=$=>{if(t.disabled)return;f.value=!1;const r=Array.from($.dataTransfer.files),b=u.accept.value;if(!b){n("file",r);return}const o=r.filter(e=>{const{type:l,name:p}=e,v=p.includes(".")?`.${p.split(".").pop()}`:"",c=l.replace(/\/.*$/,"");return b.split(",").map(E=>E.trim()).filter(E=>E).some(E=>E.startsWith(".")?v===E:/\/\*$/.test(E)?c===E.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(E)?l===E:!1)});n("file",o)},S=()=>{t.disabled||(f.value=!0)};return($,r)=>(m(),R("div",{class:h([a(i).b("dragger"),a(i).is("dragover",f.value)]),onDrop:B(w,["prevent"]),onDragover:B(S,["prevent"]),onDragleave:r[0]||(r[0]=B(b=>f.value=!1,["prevent"]))},[_($.$slots,"default")],42,yt))}}));var bt=q(gt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const kt=N(T(P({},pe),{fileList:{type:y(Array),default:()=>V([])},beforeUpload:{type:y(Function),default:k},onRemove:{type:y(Function),default:k},onStart:{type:y(Function),default:k},onSuccess:{type:y(Function),default:k},onProgress:{type:y(Function),default:k},onError:{type:y(Function),default:k},onExceed:{type:y(Function),default:k}})),$t=["onKeydown"],Et=["name","multiple","accept"],wt={name:"ElUploadContent",inheritAttrs:!1},_t=z(T(P({},wt),{props:kt,setup(s,{expose:n}){const t=s,d=A("upload"),u=W({}),i=W(),f=e=>{if(e.length===0)return;const{autoUpload:l,limit:p,fileList:v,multiple:c,onStart:E,onExceed:F}=t;if(p&&v.length+e.length>p){F(e,v);return}c||(e=e.slice(0,1));for(const M of e){const H=M;H.uid=ce(),E(H),l&&w(H)}},w=async e=>{if(i.value.value="",!t.beforeUpload)return S(e);let l;try{l=await t.beforeUpload(e)}catch{l=!1}if(l===!1){t.onRemove(e);return}let p=e;if(l instanceof Blob){l instanceof File?p=l:p=new File([l],e.name,{type:e.type});for(const v of Object.keys(e))p[v]=e[v]}S(e)},S=e=>{const{headers:l,data:p,method:v,withCredentials:c,name:E,action:F,onProgress:M,onSuccess:H,onError:fe,httpRequest:ve}=t,{uid:K}=e,I={headers:l||{},withCredentials:c,file:e,data:p,method:v,filename:E,action:F,onProgress:j=>{M(j,e)},onSuccess:j=>{H(j,e),delete u.value[K]},onError:j=>{fe(j,e),delete u.value[K]}},X=ve(I);u.value[K]=X,X instanceof Promise&&X.then(I.onSuccess,I.onError)},$=e=>{const l=e.target.files;!l||f(Array.from(l))},r=()=>{t.disabled||(i.value.value="",i.value.click())},b=()=>{r()};return n({abort:e=>{Pe(u.value).filter(e?([p])=>String(e.uid)===p:()=>!0).forEach(([p,v])=>{v instanceof XMLHttpRequest&&v.abort(),delete u.value[p]})},upload:w}),(e,l)=>(m(),R("div",{class:h([a(d).b(),a(d).m(e.listType),a(d).is("drag",e.drag)]),tabindex:"0",onClick:r,onKeydown:ie(B(b,["self"]),["enter","space"])},[e.drag?(m(),U(bt,{key:0,disabled:e.disabled,onFile:f},{default:C(()=>[_(e.$slots,"default")]),_:3},8,["disabled"])):_(e.$slots,"default",{key:1}),O("input",{ref_key:"inputRef",ref:i,class:h(a(d).e("input")),name:e.name,multiple:e.multiple,accept:e.accept,type:"file",onChange:$,onClick:l[0]||(l[0]=B(()=>{},["stop"]))},null,42,Et)],42,$t))}}));var ne=q(_t,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const le="ElUpload",Ct=s=>{var n;(n=s.url)!=null&&n.startsWith("blob:")&&URL.revokeObjectURL(s.url)},Rt=(s,n)=>{const t=J([]),d=o=>t.value.find(e=>e.uid===o.uid);function u(o){var e;(e=n.value)==null||e.abort(o)}function i(o=["ready","uploading","success","fail"]){t.value=t.value.filter(e=>!o.includes(e.status))}const f=(o,e)=>{const l=d(e);!l||(l.status="fail",t.value.splice(t.value.indexOf(l),1),s.onError(o,l,t.value),s.onChange(l,t.value))},w=(o,e)=>{const l=d(e);!l||(s.onProgress(o,l,t.value),l.status="uploading",l.percentage=Math.round(o.percent))},S=(o,e)=>{const l=d(e);!l||(l.status="success",l.response=o,s.onSuccess(o,l,t.value),s.onChange(l,t.value))},$=o=>{const e={name:o.name,percentage:0,status:"ready",size:o.size,raw:o,uid:o.uid};if(s.listType==="picture-card"||s.listType==="picture")try{e.url=URL.createObjectURL(o)}catch(l){Te(le,l.message),s.onError(l,e,t.value)}t.value.push(e),s.onChange(e,t.value)},r=async o=>{const e=o instanceof File?d(o):o;e||G(le,"file to be removed not found");const l=p=>{u(p);const v=t.value;v.splice(v.indexOf(p),1),s.onRemove(p,v),Ct(p)};s.beforeRemove?await s.beforeRemove(e,t.value)!==!1&&l(e):l(e)};function b(){t.value.filter(({status:o})=>o==="ready").forEach(({raw:o})=>{var e;return o&&((e=n.value)==null?void 0:e.upload(o))})}return x(()=>s.listType,o=>{o!=="picture-card"&&o!=="picture"||(t.value=t.value.map(e=>{const{raw:l,url:p}=e;if(!p&&l)try{e.url=URL.createObjectURL(l)}catch(v){s.onError(v,e,t.value)}return e}))}),x(()=>s.fileList,o=>{for(const e of o)e.uid||(e.uid=ce()),e.status||(e.status="success");t.value=o},{immediate:!0,deep:!0}),{abort:u,clearFiles:i,handleError:f,handleProgress:w,handleStart:$,handleSuccess:S,handleRemove:r,submit:b,uploadFiles:t}},St={name:"ElUpload"},Ut=z(T(P({},St),{props:ot,setup(s,{expose:n}){const t=s,d=Fe(),u=Oe(),i=W(),{abort:f,submit:w,clearFiles:S,uploadFiles:$,handleStart:r,handleError:b,handleRemove:o,handleSuccess:e,handleProgress:l}=Rt(t,i),p=ee(()=>t.listType==="picture-card"),v=ee(()=>T(P({},t),{onStart:r,onProgress:l,onSuccess:e,onError:b,onRemove:o}));return De(()=>{$.value.forEach(({url:c})=>{c!=null&&c.startsWith("blob:")&&URL.revokeObjectURL(c)})}),Be(ue,{accept:ze(t,"accept")}),n({abort:f,submit:w,clearFiles:S,handleStart:r,handleRemove:o}),(c,E)=>(m(),R("div",null,[a(p)&&c.showFileList?(m(),U(oe,{key:0,disabled:a(u),"list-type":c.listType,files:a($),"handle-preview":c.onPreview,onRemove:a(o)},te({append:C(()=>[c.listType==="picture-card"?(m(),U(ne,se({key:0,ref_key:"uploadRef",ref:i},a(v)),{default:C(()=>[a(d).trigger?_(c.$slots,"trigger",{key:0}):g("v-if",!0),!a(d).trigger&&a(d).default?_(c.$slots,"default",{key:1}):g("v-if",!0)]),_:3},16)):g("v-if",!0)]),_:2},[c.$slots.file?{name:"default",fn:C(({file:F})=>[_(c.$slots,"file",{file:F})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):g("v-if",!0),c.listType!=="picture-card"?(m(),U(ne,se({key:1,ref_key:"uploadRef",ref:i},a(v)),{default:C(()=>[a(d).trigger?_(c.$slots,"trigger",{key:0}):g("v-if",!0),!a(d).trigger&&a(d).default?_(c.$slots,"default",{key:1}):g("v-if",!0)]),_:3},16)):g("v-if",!0),c.$slots.trigger?_(c.$slots,"default",{key:2}):g("v-if",!0),_(c.$slots,"tip"),!a(p)&&c.showFileList?(m(),U(oe,{key:3,disabled:a(u),"list-type":c.listType,files:a($),"handle-preview":c.onPreview,onRemove:a(o)},te({_:2},[c.$slots.file?{name:"default",fn:C(({file:F})=>[_(c.$slots,"file",{file:F})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):g("v-if",!0)]))}}));var Lt=q(Ut,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Bt=He(Lt);export{Bt as E};
