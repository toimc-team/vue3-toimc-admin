import{e as E,am as M,g as h,a3 as B,b$ as x,_ as z,o as w,c as b,a as p,a$ as T,B as O,aH as q,d0 as Q,R as D,e0 as X,J as Y,I as Z,S as V,W as S,b as G,F as ee,h as te,ai as ne}from"./index.6b8e7d20.js";const oe=E({props:{url:{type:String,default:""},width:{type:String,default:"100%"}},emits:["loaded"],setup(e,{emit:t}){const n=M("lazy"),o=h(null);B(()=>{r()}),x(()=>{l()});function r(){!o.value||n.mount(o.value,e.url,s=>{const{height:i,width:u}=s;t("loaded",{dom:o.value,src:e.url,width:u,height:i})})}function l(){!o.value||n.unmount(o.value)}return{lazyRef:o}}});const re={class:"lazy__box"},se={ref:"lazyRef",class:"lazy__img"};function ie(e,t,n,o,r,l){return w(),b("div",re,[p("img",se,null,512)])}const ae=z(oe,[["render",ie],["__scopeId","data-v-7ab0742b"]]);const le=({breakpoints:e,wrapperWidth:t,gutter:n,hasAroundGutter:o,initWidth:r})=>{const l=Object.keys(e).map(c=>Number(c)).sort((c,g)=>c-g);let s=t,i=!1;for(const c of l)if(t<=c){s=c,i=!0;break}if(!i)return r;const u=e[s].rowPerView;return o?(t-n)/u-n:(t-(u-1)*n)/u};function ue(e){const t=h(0),n=h(null);T(n,s=>{const i=s[0],{width:u}=i.contentRect;t.value=u});const o=O(()=>le({wrapperWidth:t.value,breakpoints:e.breakpoints,gutter:e.gutter,hasAroundGutter:e.hasAroundGutter,initWidth:e.width})),r=O(()=>{const s=e.hasAroundGutter?-e.gutter:e.gutter;return Math.floor((t.value+s)/(o.value+e.gutter))}),l=O(()=>{const s=e.hasAroundGutter?e.gutter:-e.gutter,i=r.value*(o.value+e.gutter)+s;return(t.value-i)/2});return{waterfallWrapper:n,wrapperWidth:t,colWidth:o,cols:r,offsetX:l}}const ce=typeof window<"u"&&window!==null,C=he(),de=Object.prototype.propertyIsEnumerable,W=Object.getOwnPropertySymbols;function fe(e,...t){return t.map(o=>o.replace(/\[(\w+)\]/g,".$1").split(".").reduce((r,l)=>r&&r[l],e))}function he(){return ce&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function v(e){return typeof e=="function"||toString.call(e)==="[object Object]"}function ye(e){return typeof e=="object"?e===null:typeof e!="function"}function ge(e){return e!=="__proto__"&&e!=="constructor"&&e!=="prototype"}function pe(e,...t){if(!v(e))throw new TypeError("expected the first argument to be an object");if(t.length===0||typeof Symbol!="function"||typeof W!="function")return e;for(const n of t){const o=W(n);for(const r of o)de.call(n,r)&&(e[r]=n[r])}return e}function H(e,...t){let n=0;for(ye(e)&&(e=t[n++]),e||(e={});n<t.length;n++)if(v(t[n])){for(const o of Object.keys(t[n]))ge(o)&&(v(e[o])&&v(t[n][o])?H(e[o],t[n][o]):e[o]=t[n][o]);pe(e,t[n])}return e}function j(e,t=""){return new Promise((n,o)=>{const r=new Image;r.onload=()=>{n(r)},r.onerror=()=>{o(new Error("Image load error"))},t&&(r.crossOrigin=t&&"Anonymous"),r.src=e})}const Ae={rootMargin:"0px",threshold:0},P="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",me="";class we{constructor(t=!0,n,o){this.lazyActive=!0,this.options={loading:P,error:me,observerOptions:Ae,log:!0},this._images=new WeakMap,this.lazyActive=t,this.colWidth=o.colWidth,this.colWidth,this.config(n)}config(t={}){H(this.options,t)}mount(t,n,o){const{src:r,loading:l,error:s}=this._valueFormatter(n);if(t.setAttribute("lazy","loading"),t.setAttribute("src",l||P),!this.lazyActive)this._setImageSrc(t,r,o,s);else{if(!C){debugger;this._setImageSrc(t,r,o,s),this._log(()=>{throw new Error("Not support IntersectionObserver!")})}this._initIntersectionObserver(t,r,o,s)}}resize(t,n){const o=t.getAttribute("lazy"),r=t.getAttribute("src");o&&o==="loaded"&&r&&j(r).then(l=>{const{width:s,height:i}=l,u=this.colWidth/s*i;t.height=u;const c=t.style;c.height=`${u}px`,n({width:s,height:i})})}unmount(t){const n=this._realObserver(t);n&&n.unobserve(t),this._images.delete(t)}_setImageSrc(t,n,o,r){!n||t.getAttribute("src")===n||j(n).then(s=>{t.setAttribute("lazy","loaded"),t.removeAttribute("src"),t.setAttribute("src",n);const{width:i,height:u}=s,c=this.colWidth/i*u;t.height=c;const g=t.style;g.height=`${c}px`,o({width:i,height:u})}).catch(()=>{const s=this._realObserver(t);s&&s.disconnect(),r&&(t.setAttribute("lazy","error"),t.setAttribute("src",r)),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${n} `)}),o()})}_isOpenLazy(){return C&&this.lazyActive}_initIntersectionObserver(t,n,o,r){const l=this.options.observerOptions;this._images.set(t,new IntersectionObserver(i=>{Array.prototype.forEach.call(i,u=>{if(u.isIntersecting){const c=this._realObserver(t);c&&c.unobserve(u.target),this._setImageSrc(t,n,o,r)}})},l));const s=this._realObserver(t);s&&s.observe(t)}_valueFormatter(t){let n=t,o=this.options.loading,r=this.options.error;return v(t)&&(n=t.src,o=t.loading||this.options.loading,r=t.error||this.options.error),{src:n,loading:o,error:r}}_log(t){this.options.log&&t()}_realObserver(t){return this._images.get(t)}}const L=E({props:{list:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},imgSelector:{type:String,default:"src"},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},gutter:{type:Number,default:10},hasAroundGutter:{type:Boolean,default:!0},animationPrefix:{type:String,default:"animate__animated"},animationEffect:{type:String,default:"fade-in"},animationDuration:{type:Number,default:1e3},animationDelay:{type:Number,default:300},backgroundColor:{type:String,default:"#fff"},lazyload:{type:Boolean,default:!0},loadProps:{type:Object,default:()=>{}},delay:{type:Number,default:300}},setup(e){const t=h(e.list.map(a=>({...a,ref:h(null)}))),n=h(0),{waterfallWrapper:o,wrapperWidth:r,colWidth:l,cols:s,offsetX:i}=ue(e),u=h([]),c=new we(e.lazyload,e.loadProps,{colWidth:l.value});q("lazy",c);const g=Q(async()=>{u.value=new Array(s.value).fill(e.hasAroundGutter?e.gutter:0),t.value.forEach(a=>{U(a)}),n.value=Math.max.apply(null,u.value)},e.delay);D(()=>[r,l],()=>{g()},{deep:!0}),D(()=>e.list,()=>{const a=t.value.map(d=>_(d)),f=e.list.map(d=>_(d)),y=e.list.filter(d=>!a.includes(d.src));t.value.push(...y.map(d=>({...d,ref:h(null)}))),t.value=t.value.filter(d=>f.includes(d.src)),g()},{deep:!0});const K=a=>{const f=e.hasAroundGutter?a+1:a;return e.gutter*f+l.value*a+i.value},U=async a=>{var k,R;const f=Math.min.apply(null,u.value),y=u.value.indexOf(f),d=K(y);a.style={...a.style,transform:`translate3d(${d}px,${f}px, 0)`,width:`${l.value}px`};const I=a.width||((k=a.ref)==null?void 0:k.clientWidth),m=a.height||((R=a.ref)==null?void 0:R.clientHeight),A=l.value/I*m||0;u.value[y]+=A+e.gutter,J(a,()=>{a.style={...a.style,transition:".3s"}})},F=a=>fe(a,e.imgSelector)[0],_=(a,f)=>a[e.rowKey]||a.src||f||a;function J(a,f){const y=`${e.animationDuration/1e3}s`,d=`${e.animationDelay/1e3}s`;a.style={...a.style,visibility:"visible",duration:y,delay:d,fillMode:"both"},a.cls=`${e.animationPrefix} ${e.animationEffect}`,f&&setTimeout(()=>{f()},e.animationDuration+e.animationDelay)}return{waterfallWrapper:o,wrapperHeight:n,getRenderURL:F,getKey:_,handleLoaded:a=>{const{dom:f,src:y,width:d,height:I}=a;for(let m=0;m<t.value.length;m++){const A=t.value[m];if(A.src===y){A.dom=f,A.width=d,A.height=I;break}}g()},newLists:t}}}),N=()=>{X(e=>({"47b88e22":e.backgroundColor}))},$=L.setup;L.setup=$?(e,t)=>(N(),$(e,t)):N;const be={class:"bg-gray-900 rounded-lg shadow-md overflow-hidden transition-all duration-300 ease-linear hover:shadow-lg hover:shadow-gray-600 group"},ve={class:"overflow-hidden"};function _e(e,t,n,o,r,l){const s=ae;return w(),b("ul",{ref:"waterfallWrapper",class:"waterfall-list",style:V({height:`${e.wrapperHeight}px`})},[(w(!0),b(Y,null,Z(e.newLists,(i,u)=>(w(),b("li",{key:e.getKey(i,u),ref_for:!0,ref:c=>i.ref=c,class:"waterfall-item",style:V(i.style)},[p("div",{class:ee(["waterfall-card",i==null?void 0:i.cls])},[S(e.$slots,"item",{item:i,index:u},()=>[p("div",be,[p("div",ve,[G(s,{url:i.src,class:"cursor-pointer transition-all duration-300 ease-linear group-hover:scale-105",onLoaded:e.handleLoaded},null,8,["url","onLoaded"])])])],!0),S(e.$slots,"default",{},void 0,!0)],2)],4))),128))],4)}const Ie=z(L,[["render",_e],["__scopeId","data-v-efdfa17a"]]),Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABN9JREFUaEPtWM1rJEUUf69nujebjUFDj7FqZggBkUWiKJkIYf0C2Yuag5f8AyKukMU9eRA0m1VYvLkeJKKehYigRg8ushFWjZgEFj0Y9JBDJtU9M00UiTGZ7uknJdMy29Ofk5noyBb0pevV771fvVev3iuEPh/Y5/bDLQL/tge75gHDMKaI6BkAeAwA7mh+tzcJ/gYAv8qPiL5wXffjYrH4QzfIH4mAZVn5er1+joieRsQH0hhERN8h4peapi3qur6TZm2rbEcEarUadxxHGv4cANzVqfLmOhMR381ms4u5XE6kxUpNQAhxDgDmu2C431YTAN7gnL+ZhkQqAkIICf5iGgVpZRHxQ8bYbNJ1iQiUy+V7FEV5DwAeSQp8RLky57yYBCMRAcMw5onoYgLAb4jomqqqVwHA3N3drcg1IyMjozLkbNs+oyjKWSJ6Ig4LEX9kjN0fKxcnQESaEGIdEe+LkH0fEd9hjK3F4cn5Zsp9HgCejZJHxIuMsYVImajJ9fV1dWxsbMC27WsAUPLLIuJXAPBSUsP965tE3g7C9mRlpsvn8zJ8A0doCBERViqVwUwmoziOU5Kh4UOQO34eEe0kux4lI4T4HACeDJExVVWdDEuxUQQ0y7JOeKCO45x2XfcyIrqIeIUxJpV2bRiG8RYRnQ8CRMTXGGOvBs4F/SQipVarDSJiG8GDgwOnWCz+2TXLW4AMw/iUiGYCsE1N00pBN3agB4johGVZWpCRKysr+7Ozs40eEZD11Pch2K9zzl9pO4dBwqZpnpKx75/b29uzx8fHD3phvIcphJAHNig73eCcPxhLYH5+Xpmbmzt13Lvv6WtmpkAvIOJD/ozXFkJe6vQTsG27wTnf7+Xut3jhawA4E6DrMuf85db/bQTC4l/X9UNErB8HAcMwLhFRW7wDwLec85uItRHY3t4+OTAwkPUbquv6PiL25PD6dVWr1Ycdx7kesFk/cc7vjfRA2AHWdf0PeQcchweq1erdjuP8EpROOecskkC1Wh0Kyv+6ru8hIh0Hgc3NzduGh4d/D9B1wDk/+f8m0Pch1PeHOCyNViqVw4mJiWNJozs7O5cQsbM0GnaR6bruIGJPijj/YRVCHOkiQ8uyhvq2lJCGCyEGVVXN/JeKOSK6kc/n44s5aXTfl9NRDU2vijoiUk3TvEpEjwfdwKkamqYXbmopW0F70ZUJIRYBQL5UtI3ULWWTwD9NfRCorut1RDzsRmlhGMZTRPRZCFZnTb0EC0upniLpidXV1XqnLebS0lJmenpay2QynwDA2RACL3DOpXcCR+zL3NbW1sDQ0JAatdOy1VxbW7OTEpGGT01NqR5u2LsTAFzhnF+I0h1LQC4Oq4/8wPKAM8YcAJB9g6xcvepV6pFfxjCMrD9Fh7w7XeecPxoXookIRN0NcQqSznvvTgBwp6IoHzUajQ8KhcLPcesTE4jLTHGKks6nbV1TEfAOdqFQkAev7dklqZFBco1Gwy2Xy/VSqZTqqTI1AS/FAoBaq9W0oO4tDREiolwuJ6tcu5OOryMCnoHyxpZEKpVKNq1H5I6Pjo7KAy8N77jXPhKB1p2WD2IzMzOZyclJpVwuK6qqKoqi/I3vui7Ztu0WCgV3Y2PDXV5ebiwsLHRsdKverhFIEzbdlL1FoJu72QlW33vgL+ntak98Gx9aAAAAAElFTkSuQmCC",Ee=E({setup(){async function e(){const l=[];try{const s=await ne.get("/api/public/mix");if(s.status===200){const i=s.data;i.code===200&&l.push(...i.data||[])}}catch{}return l}function t(){const l=h([]),s=te({rowKey:"id",gutter:10,hasAroundGutter:!0,width:320,breakpoints:{1200:{rowPerView:4},800:{rowPerView:3},500:{rowPerView:2}},animationEffect:"animate__fadeInUp",animationDuration:1e3,animationDelay:300,backgroundColor:"#2C2E3A",imgSelector:"src.original",loadProps:{loading:Oe},lazyload:!0});B(async()=>{await i()});async function i(){(await e()).map(c=>{l.value.push({src:c})})}return{list:l,options:s,handleLoadMore:i}}const{list:n,options:o,handleLoadMore:r}=t();return{list:n,options:o,handleLoadMore:r}}}),ze={class:"h-screen flex overflow-hidden"},Le={class:"flex-auto overflow-y-auto"},ke={class:"flex justify-center py-10 bg-gray-900"};function Re(e,t,n,o,r,l){const s=Ie;return w(),b("div",ze,[p("div",Le,[G(s,{list:e.list,"row-key":e.options.rowKey,gutter:e.options.gutter,"has-around-gutter":e.options.hasAroundGutter,width:e.options.width,breakpoints:e.options.breakpoints,"img-selector":e.options.imgSelector,"background-color":e.options.backgroundColor,"animation-effect":e.options.animationEffect,"animation-duration":e.options.animationDuration,"animation-delay":e.options.animationDelay,lazyload:e.options.lazyload,"load-props":e.options.loadProps},null,8,["list","row-key","gutter","has-around-gutter","width","breakpoints","img-selector","background-color","animation-effect","animation-duration","animation-delay","lazyload","load-props"]),p("div",ke,[p("button",{class:"px-5 py-2 rounded-full bg-gray-700 text-md text-white cursor-pointer hover:bg-gray-800 transition-all duration-300",onClick:t[0]||(t[0]=(...i)=>e.handleLoadMore&&e.handleLoadMore(...i))},"\u52A0\u8F7D\u66F4\u591A")])])])}const Se=z(Ee,[["render",Re]]);export{Se as default};
