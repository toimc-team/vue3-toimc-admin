var ke=Object.defineProperty,xe=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var de=(o,s,n)=>s in o?ke(o,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[s]=n,j=(o,s)=>{for(var n in s||(s={}))ze.call(s,n)&&de(o,n,s[n]);if(ue)for(var n of ue(s))Le.call(s,n)&&de(o,n,s[n]);return o},J=(o,s)=>xe(o,Ie(s));import{ab as B,s as ve,x as le,al as pe,ao as ce,e as me,cC as fe,cD as Ce,cE as Ee,av as ge,A as we,ad as Se,g,cF as Oe,bo as Ne,B as w,R as oe,aK as he,a3 as ye,o as h,j as se,b as c,w as I,a as p,F as u,C as t,a9 as Te,H as y,D as S,bk as $e,c as O,bb as Ae,at as Me,J as re,cG as Be,bl as De,G as Ve,cH as Ye,cI as Fe,I as Re,a7 as He,a8 as je,S as ie,W as K,aa as Pe,ch as Xe,L as _e,cJ as ne,a6 as M,a4 as D,cK as Ze,aq as be,bB as We,bJ as Ge,T as Je,t as Ke,ae as qe,af as Qe,cL as Ue,cM as et,cN as tt}from"./index.58bcf13a.js";const at=()=>B&&/firefox/i.test(window.navigator.userAgent),nt=ve({urlList:{type:le(Array),default:()=>pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),lt={close:()=>!0,switch:o=>ce(o)},ot=["src"],st={name:"ElImageViewer"},rt=me(J(j({},st),{props:nt,emits:lt,setup(o,{emit:s}){const n=o,E={CONTAIN:{name:"contain",icon:fe(Ce)},ORIGINAL:{name:"original",icon:fe(Ee)}},q=at()?"DOMMouseScroll":"mousewheel",{t:z}=ge(),r=we("image-viewer"),{nextZIndex:Q}=Se(),N=g(),_=g([]),b=Oe(),k=g(!0),d=g(n.initialIndex),v=Ne(E.CONTAIN),i=g({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=w(()=>{const{urlList:a}=n;return a.length<=1}),T=w(()=>d.value===0),P=w(()=>d.value===n.urlList.length-1),U=w(()=>n.urlList[d.value]),Y=w(()=>{const{scale:a,deg:e,offsetX:l,offsetY:f,enableTransition:L}=i.value;let m=l/a,C=f/a;switch(e%360){case 90:case-270:[m,C]=[C,-m];break;case 180:case-180:[m,C]=[-m,-C];break;case 270:case-90:[m,C]=[-C,m];break}const A={transform:`scale(${a}) rotate(${e}deg) translate(${m}px, ${C}px)`,transition:L?"transform .3s":""};return v.value.name===E.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A}),ee=w(()=>ce(n.zIndex)?n.zIndex:Q());function $(){te(),s("close")}function F(){const a=ne(l=>{switch(l.code){case M.esc:n.closeOnPressEscape&&$();break;case M.space:H();break;case M.left:W();break;case M.up:x("zoomIn");break;case M.right:G();break;case M.down:x("zoomOut");break}}),e=ne(l=>{(l.wheelDelta?l.wheelDelta:-l.detail)>0?x("zoomIn",{zoomRate:1.2,enableTransition:!1}):x("zoomOut",{zoomRate:1.2,enableTransition:!1})});b.run(()=>{D(document,"keydown",a),D(document,q,e)})}function te(){b.stop()}function ae(){k.value=!1}function X(a){k.value=!1,a.target.alt=z("el.image.error")}function Z(a){if(k.value||a.button!==0||!N.value)return;i.value.enableTransition=!1;const{offsetX:e,offsetY:l}=i.value,f=a.pageX,L=a.pageY,m=ne(A=>{i.value=J(j({},i.value),{offsetX:e+A.pageX-f,offsetY:l+A.pageY-L})}),C=D(document,"mousemove",m);D(document,"mouseup",()=>{C()}),a.preventDefault()}function R(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function H(){if(k.value)return;const a=Ze(E),e=Object.values(E),l=v.value.name,L=(e.findIndex(m=>m.name===l)+1)%a.length;v.value=E[a[L]],R()}function W(){if(T.value&&!n.infinite)return;const a=n.urlList.length;d.value=(d.value-1+a)%a}function G(){if(P.value&&!n.infinite)return;const a=n.urlList.length;d.value=(d.value+1)%a}function x(a,e={}){if(k.value)return;const{zoomRate:l,rotateDeg:f,enableTransition:L}=j({zoomRate:1.4,rotateDeg:90,enableTransition:!0},e);switch(a){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/l).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*l).toFixed(3)));break;case"clockwise":i.value.deg+=f;break;case"anticlockwise":i.value.deg-=f;break}i.value.enableTransition=L}return oe(U,()=>{he(()=>{const a=_.value[0];a!=null&&a.complete||(k.value=!0)})}),oe(d,a=>{R(),s("switch",a)}),ye(()=>{var a,e;F(),(e=(a=N.value)==null?void 0:a.focus)==null||e.call(a)}),(a,e)=>(h(),se(Xe,{to:"body",disabled:!a.teleported},[c(Pe,{name:"viewer-fade",appear:""},{default:I(()=>[p("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:u(t(r).e("wrapper")),style:ie({zIndex:t(ee)})},[p("div",{class:u(t(r).e("mask")),onClick:e[0]||(e[0]=Te(l=>a.hideOnClickModal&&$(),["self"]))},null,2),y(" CLOSE "),p("span",{class:u([t(r).e("btn"),t(r).e("close")]),onClick:$},[c(t(S),null,{default:I(()=>[c(t($e))]),_:1})],2),y(" ARROW "),t(V)?y("v-if",!0):(h(),O(re,{key:0},[p("span",{class:u([t(r).e("btn"),t(r).e("prev"),t(r).is("disabled",!a.infinite&&t(T))]),onClick:W},[c(t(S),null,{default:I(()=>[c(t(Ae))]),_:1})],2),p("span",{class:u([t(r).e("btn"),t(r).e("next"),t(r).is("disabled",!a.infinite&&t(P))]),onClick:G},[c(t(S),null,{default:I(()=>[c(t(Me))]),_:1})],2)],64)),y(" ACTIONS "),p("div",{class:u([t(r).e("btn"),t(r).e("actions")])},[p("div",{class:u(t(r).e("actions__inner"))},[c(t(S),{onClick:e[1]||(e[1]=l=>x("zoomOut"))},{default:I(()=>[c(t(Be))]),_:1}),c(t(S),{onClick:e[2]||(e[2]=l=>x("zoomIn"))},{default:I(()=>[c(t(De))]),_:1}),p("i",{class:u(t(r).e("actions__divider"))},null,2),c(t(S),{onClick:H},{default:I(()=>[(h(),se(Ve(t(v).icon)))]),_:1}),p("i",{class:u(t(r).e("actions__divider"))},null,2),c(t(S),{onClick:e[3]||(e[3]=l=>x("anticlockwise"))},{default:I(()=>[c(t(Ye))]),_:1}),c(t(S),{onClick:e[4]||(e[4]=l=>x("clockwise"))},{default:I(()=>[c(t(Fe))]),_:1})],2)],2),y(" CANVAS "),p("div",{class:u(t(r).e("canvas"))},[(h(!0),O(re,null,Re(a.urlList,(l,f)=>He((h(),O("img",{ref_for:!0,ref:L=>_.value[f]=L,key:l,src:l,style:ie(t(Y)),class:u(t(r).e("img")),onLoad:ae,onError:X,onMousedown:Z},null,46,ot)),[[je,f===d.value]])),128))],2),K(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var it=_e(rt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ct=be(it),ut=ve({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:le([String,Object])},previewSrcList:{type:le(Array),default:()=>pe([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),dt={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>ce(o),close:()=>!0},ft=["src","loading"],vt={key:0},pt={name:"ElImage",inheritAttrs:!1},mt=me(J(j({},pt),{props:ut,emits:dt,setup(o,{emit:s}){const n=o;let E="";const{t:q}=ge(),z=we("image"),r=We(),Q=Ge(),N=g(),_=g(!1),b=g(!0),k=g(!1),d=g(),v=g(),i=B&&"loading"in HTMLImageElement.prototype;let V,T;const P=w(()=>r.style),U=w(()=>{const{fit:e}=n;return B&&e?{objectFit:e}:{}}),Y=w(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),ee=w(()=>{const{previewSrcList:e,initialIndex:l}=n;let f=l;return l>e.length-1&&(f=0),f}),$=w(()=>n.loading==="eager"?!1:!i&&n.loading==="lazy"||n.lazy),F=()=>{!B||(b.value=!0,_.value=!1,N.value=n.src)};function te(e){b.value=!1,_.value=!1,s("load",e)}function ae(e){b.value=!1,_.value=!0,s("error",e)}function X(){et(d.value,v.value)&&(F(),H())}const Z=tt(X,200);async function R(){var e;if(!B)return;await he();const{scrollContainer:l}=n;qe(l)?v.value=l:Qe(l)&&l!==""?v.value=(e=document.querySelector(l))!=null?e:void 0:d.value&&(v.value=Ue(d.value)),v.value&&(V=D(v,"scroll",Z),setTimeout(()=>X(),100))}function H(){!B||!v.value||!Z||(V==null||V(),v.value=void 0)}function W(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function G(){!Y.value||(T=D("wheel",W,{passive:!1}),E=document.body.style.overflow,document.body.style.overflow="hidden",k.value=!0)}function x(){T==null||T(),document.body.style.overflow=E,k.value=!1,s("close")}function a(e){s("switch",e)}return oe(()=>n.src,()=>{$.value?(b.value=!0,_.value=!1,H(),R()):F()}),ye(()=>{$.value?R():F()}),(e,l)=>(h(),O("div",{ref_key:"container",ref:d,class:u([t(z).b(),e.$attrs.class]),style:ie(t(P))},[N.value!==void 0&&!_.value?(h(),O("img",Je({key:0},t(Q),{src:N.value,loading:e.loading,style:t(U),class:[t(z).e("inner"),t(Y)&&t(z).e("preview"),b.value&&t(z).is("loading")],onClick:G,onLoad:te,onError:ae}),null,16,ft)):y("v-if",!0),b.value||_.value?(h(),O("div",{key:1,class:u(t(z).e("wrapper"))},[b.value?K(e.$slots,"placeholder",{key:0},()=>[p("div",{class:u(t(z).e("placeholder"))},null,2)]):_.value?K(e.$slots,"error",{key:1},()=>[p("div",{class:u(t(z).e("error"))},Ke(t(q)("el.image.error")),3)]):y("v-if",!0)],2)):y("v-if",!0),t(Y)?(h(),O(re,{key:2},[k.value?(h(),se(t(ct),{key:0,"z-index":e.zIndex,"initial-index":t(ee),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:x,onSwitch:a},{default:I(()=>[e.$slots.viewer?(h(),O("div",vt,[K(e.$slots,"viewer")])):y("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):y("v-if",!0)],64)):y("v-if",!0)],6))}}));var gt=_e(mt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const yt=be(gt);export{yt as E};
